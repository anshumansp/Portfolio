import{r as t,j as e}from"./index-9e019d01.js";import{v as o,V as n,M as r,ae as s,af as i,ad as a,j as l,x as c,ag as u,ah as p,O as f,_ as m,u as h,J as d,C as y}from"./react-three-fiber.esm-5dd02b2d.js";import{L as x,O as g}from"./Loader-8b358bd1.js";import{P as w}from"./Preload-31fe36be.js";import{m as b}from"./react-merge-refs.esm-d6fcc1fa.js";class j extends o{constructor(t,e,o,i){super();const a=[],l=[],c=[],u=new n,p=new r;p.makeRotationFromEuler(o),p.setPosition(e);const f=new r;function m(e,o,n){o.applyMatrix4(t.matrixWorld),o.applyMatrix4(f),n.transformDirection(t.matrixWorld),e.push(new E(o.clone(),n.clone()))}function h(t,e){const o=[],n=.5*Math.abs(i.dot(e));for(let r=0;r<t.length;r+=3){let s,i,a,l,c,u,p,f=0;switch(s=t[r+0].position.dot(e)-n>0,i=t[r+1].position.dot(e)-n>0,a=t[r+2].position.dot(e)-n>0,f=(s?1:0)+(i?1:0)+(a?1:0),f){case 0:o.push(t[r]),o.push(t[r+1]),o.push(t[r+2]);break;case 1:if(s&&(l=t[r+1],c=t[r+2],u=d(t[r],l,e,n),p=d(t[r],c,e,n)),i){l=t[r],c=t[r+2],u=d(t[r+1],l,e,n),p=d(t[r+1],c,e,n),o.push(u),o.push(c.clone()),o.push(l.clone()),o.push(c.clone()),o.push(u.clone()),o.push(p);break}a&&(l=t[r],c=t[r+1],u=d(t[r+2],l,e,n),p=d(t[r+2],c,e,n)),o.push(l.clone()),o.push(c.clone()),o.push(u),o.push(p),o.push(u.clone()),o.push(c.clone());break;case 2:s||(l=t[r].clone(),c=d(l,t[r+1],e,n),u=d(l,t[r+2],e,n),o.push(l),o.push(c),o.push(u)),i||(l=t[r+1].clone(),c=d(l,t[r+2],e,n),u=d(l,t[r],e,n),o.push(l),o.push(c),o.push(u)),a||(l=t[r+2].clone(),c=d(l,t[r],e,n),u=d(l,t[r+1],e,n),o.push(l),o.push(c),o.push(u))}}return o}function d(t,e,o,r){const s=t.position.dot(o)-r,i=s/(s-(e.position.dot(o)-r));return new E(new n(t.position.x+i*(e.position.x-t.position.x),t.position.y+i*(e.position.y-t.position.y),t.position.z+i*(e.position.z-t.position.z)),new n(t.normal.x+i*(e.normal.x-t.normal.x),t.normal.y+i*(e.normal.y-t.normal.y),t.normal.z+i*(e.normal.z-t.normal.z)))}f.copy(p).invert(),function(){let e,o=[];const r=new n,s=new n;if(!0===t.geometry.isGeometry)return void console.error("THREE.DecalGeometry no longer supports THREE.Geometry. Use BufferGeometry instead.");const f=t.geometry,d=f.attributes.position,y=f.attributes.normal;if(null!==f.index){const t=f.index;for(e=0;e<t.count;e++)r.fromBufferAttribute(d,t.getX(e)),s.fromBufferAttribute(y,t.getX(e)),m(o,r,s)}else for(e=0;e<d.count;e++)r.fromBufferAttribute(d,e),s.fromBufferAttribute(y,e),m(o,r,s);for(o=h(o,u.set(1,0,0)),o=h(o,u.set(-1,0,0)),o=h(o,u.set(0,1,0)),o=h(o,u.set(0,-1,0)),o=h(o,u.set(0,0,1)),o=h(o,u.set(0,0,-1)),e=0;e<o.length;e++){const t=o[e];c.push(.5+t.position.x/i.x,.5+t.position.y/i.y),t.position.applyMatrix4(p),a.push(t.position.x,t.position.y,t.position.z),l.push(t.normal.x,t.normal.y,t.normal.z)}}(),this.setAttribute("position",new s(a,3)),this.setAttribute("normal",new s(l,3)),this.setAttribute("uv",new s(c,2))}}class E{constructor(t,e){this.position=t,this.normal=e}clone(){return new this.constructor(this.position.clone(),this.normal.clone())}}const v=t=>t===Object(t)&&!Array.isArray(t)&&"function"!=typeof t;function A(e,o){const n=i((t=>t.gl)),r=a(l,v(e)?Object.values(e):e);if(t.useLayoutEffect((()=>{null==o||o(r)}),[o]),t.useEffect((()=>{(Array.isArray(r)?r:[r]).forEach(n.initTexture)}),[n,r]),v(e)){const t=Object.keys(e),o={};return t.forEach((e=>Object.assign(o,{[e]:r[t.indexOf(e)]}))),o}return r}function M(t=[0,0,0]){return function(t){return Array.isArray(t)}(t)?t:t instanceof n||t instanceof u?[t.x,t.y,t.z]:[t,t,t]}A.preload=t=>a.preload(l,t),A.clear=t=>a.clear(l,t);const O=t.forwardRef((function({debug:e,depthTest:o=!1,polygonOffsetFactor:r=-10,map:s,mesh:i,children:a,position:l,rotation:h,scale:d,...y},x){const g=t.useRef(null);t.useImperativeHandle(x,(()=>g.current));const w=t.useRef(null);return t.useLayoutEffect((()=>{const t=(null==i?void 0:i.current)||g.current.parent,e=g.current;if(!(t instanceof c))throw new Error('Decal must have a Mesh as parent or specify its "mesh" prop');const o={position:new n,rotation:new u,scale:new n(1,1,1)};if(t){p(o,{position:l,scale:d});const n=t.matrixWorld.clone();if(t.matrixWorld.identity(),h&&"number"!=typeof h)p(o,{rotation:h});else{const e=new f;e.position.copy(o.position),e.lookAt(t.position),"number"==typeof h&&e.rotateZ(h),p(o,{rotation:e.rotation})}return e.geometry=new j(t,o.position,o.rotation,o.scale),w.current&&(p(w.current,o),w.current.traverse((t=>t.raycast=()=>null))),t.matrixWorld=n,()=>{e.geometry.dispose()}}}),[i,...M(l),...M(d),...M(h)]),t.createElement("mesh",m({ref:g,"material-transparent":!0,"material-polygonOffset":!0,"material-polygonOffsetFactor":r,"material-depthTest":o,"material-map":s},y),a,e&&t.createElement("mesh",{ref:w},t.createElement("boxGeometry",null),t.createElement("meshNormalMaterial",{wireframe:!0}),t.createElement("axesHelper",null)))})),z=t.forwardRef((({children:e,enabled:o=!0,speed:n=1,rotationIntensity:r=1,floatIntensity:s=1,floatingRange:i=[-.1,.1],...a},l)=>{const c=t.useRef(null),u=t.useRef(1e4*Math.random());return h((t=>{var e,a;if(!o||0===n)return;const l=u.current+t.clock.getElapsedTime();c.current.rotation.x=Math.cos(l/4*n)/8*r,c.current.rotation.y=Math.sin(l/4*n)/8*r,c.current.rotation.z=Math.sin(l/4*n)/20*r;let p=Math.sin(l/4*n)/10;p=d.mapLinear(p,-.1,.1,null!==(e=null==i?void 0:i[0])&&void 0!==e?e:-.1,null!==(a=null==i?void 0:i[1])&&void 0!==a?a:.1),c.current.position.y=p*s,c.current.updateMatrix()})),t.createElement("group",a,t.createElement("group",{ref:b([c,l]),matrixAutoUpdate:!1},e))})),R=t=>{const{imgUrl:o}=t,n=A(o);return e.jsxs(z,{speed:1.75,rotationIntensity:1,floatIntensity:2,children:[e.jsx("ambientLight",{intensity:.6}),e.jsx("directionalLight",{position:[0,0,.05]}),e.jsxs("mesh",{castShadow:!0,receiveShadow:!0,scale:2.75,children:[e.jsx("icosahedronGeometry",{args:[1,1]}),e.jsx("meshStandardMaterial",{color:"#d0d2d9",emissive:"#d0d2d9",emissiveIntensity:1,polygonOffset:!0,polygonOffsetFactor:-5,flatShading:!0}),e.jsx(O,{position:[0,0,1],rotation:[2*Math.PI,0,6.25],flatShading:!0,map:n})]})]})},k=({icon:o})=>e.jsxs(y,{frameloop:"demand",gl:{preserveDrawingBuffer:!0},children:[e.jsxs(t.Suspense,{fallback:e.jsx(x,{}),children:[e.jsx(g,{enableZoom:!1}),e.jsx(R,{imgUrl:o})]}),e.jsx(w,{all:!0})]});export{k as default};
