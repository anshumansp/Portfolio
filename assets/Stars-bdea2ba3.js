import{r as e,j as t}from"./index-1ff4a494.js";import{_ as r,P as a,R as n,u as o,D as s,M as i,V as c,C as l}from"./react-three-fiber.esm-9fd72dad.js";import{m as u}from"./react-merge-refs.esm-d6fcc1fa.js";const m=parseInt(n.replace(/\D+/g,""))>=154?"opaque_fragment":"output_fragment";class d extends a{constructor(e){super(e),this.onBeforeCompile=(e,t)=>{const{isWebGL2:r}=t.capabilities;e.fragmentShader=e.fragmentShader.replace(`#include <${m}>`,`\n        ${r?`#include <${m}>`:`#extension GL_OES_standard_derivatives : enable\n#include <${m}>`}\n      vec2 cxy = 2.0 * gl_PointCoord - 1.0;\n      float r = dot(cxy, cxy);\n      float delta = fwidth(r);     \n      float mask = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\n      gl_FragColor = vec4(gl_FragColor.rgb, mask * gl_FragColor.a );\n      #include <tonemapping_fragment>\n      #include <${parseInt(n.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment"}>\n      `)}}}const f=e.forwardRef(((t,a)=>{const[n]=e.useState((()=>new d(null)));return e.createElement("primitive",r({},t,{object:n,ref:a,attach:"material"}))}));let g,p;const h=e.createContext(null),b=new i,y=new c,x=e.forwardRef((({children:t,range:a,limit:n=1e3,...i},c)=>{const l=e.useRef(null),[m,d]=e.useState([]),[[f,x,E]]=e.useState((()=>[new Float32Array(3*n),Float32Array.from({length:3*n},(()=>1)),Float32Array.from({length:n},(()=>1))]));e.useEffect((()=>{l.current.geometry.attributes.position.needsUpdate=!0})),o((()=>{for(l.current.updateMatrix(),l.current.updateMatrixWorld(),b.copy(l.current.matrixWorld).invert(),l.current.geometry.drawRange.count=Math.min(n,void 0!==a?a:n,m.length),g=0;g<m.length;g++)p=m[g].current,p.getWorldPosition(y).applyMatrix4(b),y.toArray(f,3*g),l.current.geometry.attributes.position.needsUpdate=!0,p.matrixWorldNeedsUpdate=!0,p.color.toArray(x,3*g),l.current.geometry.attributes.color.needsUpdate=!0,E.set([p.size],g),l.current.geometry.attributes.size.needsUpdate=!0}));const z=e.useMemo((()=>({getParent:()=>l,subscribe:e=>(d((t=>[...t,e])),()=>d((t=>t.filter((t=>t.current!==e.current)))))})),[]);return e.createElement("points",r({userData:{instances:m},matrixAutoUpdate:!1,ref:u([c,l]),raycast:()=>null},i),e.createElement("bufferGeometry",null,e.createElement("bufferAttribute",{attach:"attributes-position",count:f.length/3,array:f,itemSize:3,usage:s}),e.createElement("bufferAttribute",{attach:"attributes-color",count:x.length/3,array:x,itemSize:3,usage:s}),e.createElement("bufferAttribute",{attach:"attributes-size",count:E.length,array:E,itemSize:1,usage:s})),e.createElement(h.Provider,{value:z},t))})),E=e.forwardRef((({children:t,positions:a,colors:n,sizes:i,stride:c=3,...l},m)=>{const d=e.useRef(null);return o((()=>{const e=d.current.geometry.attributes;e.position.needsUpdate=!0,n&&(e.color.needsUpdate=!0),i&&(e.size.needsUpdate=!0)})),e.createElement("points",r({ref:u([m,d])},l),e.createElement("bufferGeometry",null,e.createElement("bufferAttribute",{attach:"attributes-position",count:a.length/c,array:a,itemSize:c,usage:s}),n&&e.createElement("bufferAttribute",{attach:"attributes-color",count:n.length/c,array:n,itemSize:3,usage:s}),i&&e.createElement("bufferAttribute",{attach:"attributes-size",count:i.length/c,array:i,itemSize:1,usage:s})),t)})),z=e.forwardRef(((t,a)=>t.positions instanceof Float32Array?e.createElement(E,r({},t,{ref:a})):e.createElement(x,r({},t,{ref:a})))),A=r=>{const a=e.useRef(),n=new Float32Array(15e3);for(let e=0;e<5e3;e++)n[3*e]=2*Math.random()-1,n[3*e+1]=2*Math.random()-1,n[3*e+2]=2*Math.random()-1;return o(((e,t)=>{a.current&&(a.current.rotation.x-=t/20,a.current.rotation.y-=t/30)})),t.jsx("group",{rotation:[0,0,Math.PI/4],children:t.jsx(z,{ref:a,positions:n,frustumCulled:!1,...r,children:t.jsx(f,{transparent:!0,color:"#f272c8",size:.002,sizeAttenuation:!0,depthWrite:!1})})})},_=()=>t.jsx("div",{className:"w-full h-auto absolute inset-0 z-[-1]",children:t.jsx(l,{camera:{position:[0,0,1]},children:t.jsx(A,{})})});export{_ as default};
